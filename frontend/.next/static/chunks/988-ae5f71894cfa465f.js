"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[988],{8045:function(e,t,r){r.d(t,{Z:function(){return p}});var s=r(37821),a=r(46362),n=r(16922),l=r(15758),i=r(58022),o=r(79044),c=r(35619),d=r(32751);function u(e){let{children:t,className:r}=e;return(0,s.jsx)("div",{className:"absolute bottom-full left-0 mb-2 opacity-0 group-hover:opacity-100 group-focus-within:opacity-100 transition-opacity duration-200 delay-300 z-50 pointer-events-none ".concat(r||""),children:(0,s.jsx)("div",{className:"rounded-lg px-4 py-3 text-xs shadow-2xl border border-gray-700 bg-gray-900 text-white w-[90vw] max-w-[400px] max-h-[70vh] overflow-y-auto pointer-events-auto",children:t})})}function x(e){let{title:t,revenueHr:r,costHr:a,profitHr:n,outputSoldUnits:l,costItems:i,loading:o,note:c,breakdown:d}=e,u=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(e),x=e=>new Intl.NumberFormat("en-US",{maximumFractionDigits:2}).format(e),m=a>0?a:i.reduce((e,t)=>e+t.costHr,0),p=i.map(e=>({...e,pct:m>0?e.costHr/m*100:0})),h=d&&0!==d.length?d.reduce((e,t)=>e+t.value,0):null,v=null===h||.01>Math.abs((h||0)-r);return(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("p",{className:"text-sm font-semibold",children:t}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[null!==h&&(0,s.jsx)("span",{className:"text-[10px] ".concat(v?"text-emerald-400":"text-red-400"),children:v?"Validated":"Mismatch"}),o?(0,s.jsx)("span",{className:"text-[10px] text-gray-400",children:"Loading…"}):null]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("p",{className:"text-[10px] text-gray-400",children:"Revenue/hr"}),(0,s.jsx)("p",{className:"font-mono",children:u(r)})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("p",{className:"text-[10px] text-gray-400",children:"Cost/hr"}),(0,s.jsx)("p",{className:"font-mono",children:u(a)})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("p",{className:"text-[10px] text-gray-400",children:"Profit/hr"}),(0,s.jsx)("p",{className:"font-mono",children:u(n)})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("p",{className:"text-[10px] text-gray-400",children:"Output Sold (u/hr)"}),(0,s.jsx)("p",{className:"font-mono",children:x(l)})]})]}),d&&d.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-[11px] text-gray-300 mb-1",children:"Revenue Breakdown"}),(0,s.jsxs)("div",{className:"space-y-1",children:[d.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-[11px] text-gray-300",children:e.label}),(0,s.jsx)("span",{className:"font-mono text-[11px]",children:u(e.value)})]},e.label)),(0,s.jsxs)("div",{className:"flex items-center justify-between border-t border-gray-700 pt-1 mt-1",children:[(0,s.jsx)("span",{className:"text-[11px] text-gray-400",children:"Total"}),(0,s.jsx)("span",{className:"font-mono text-[11px]",children:u(h||0)})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-[11px] text-gray-300 mb-1",children:"Cost Breakdown"}),(0,s.jsx)("div",{className:"space-y-1",children:0===p.length?(0,s.jsx)("p",{className:"text-[11px] text-gray-500",children:"No input cost components"}):(0,s.jsxs)(s.Fragment,{children:[p.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-[11px] text-gray-300",children:e.name}),(0,s.jsxs)("span",{className:"font-mono text-[11px]",children:[u(e.costHr)," (",x(e.pct),"%)"]})]},e.name)),(0,s.jsxs)("div",{className:"flex items-center justify-between border-t border-gray-700 pt-1 mt-1",children:[(0,s.jsx)("span",{className:"text-[11px] text-gray-400",children:"Total"}),(0,s.jsx)("span",{className:"font-mono text-[11px]",children:u(m)})]})]})})]}),c?(0,s.jsx)("div",{className:"rounded-md border border-gray-700 bg-gray-800 px-2 py-1",children:(0,s.jsx)("p",{className:"text-[10px] text-gray-400",children:c})}):null]})}r(58078);var m=r(74542);function p(e){var t,r,p,h,v,g,b,j,f,y;let{sectorType:N,stateCode:w,stateName:k,stateMultiplier:E,stateGrowthFactor:U=1,enteredDate:P,units:C,corporation:H,canExtract:O,extractableResources:S,requiredResource:R,producedProduct:F,productDemands:D,revenue:M,profit:Z,showActions:I=!1,onAbandonUnit:A,onBuildUnit:B,abandoningUnit:L=null,building:T=null,canBuild:V=!0,buildCost:_=1e4,formatCurrency:G,calculateUnitProfit:q,UNIT_ECONOMICS:z,SECTORS_CAN_EXTRACT:W,commodityPrices:Y,productPrices:J,EXTRACTION_OUTPUT_RATE:K=2,unitFlows:Q,productReferenceValues:X}=e,$=X||{"Technology Products":5e3,"Manufactured Goods":1500,Electricity:200,"Food Products":500,"Construction Capacity":2500,"Pharmaceutical Products":8e3,"Defense Equipment":15e3,"Logistics Capacity":1e3,Steel:850},ee="Defense"===N,et=!("Light Industry"===N||"Heavy Industry"===N||"Mining"===N),er=!!F,es=C.retail+C.production+C.service+C.extraction,ea=Math.floor(15*E),en=ea>0?es/ea*100:0,el=es>=ea,ei=(()=>{if(null==Q?void 0:Q.production)return Q.production;let e={};return e.Electricity=.5,D&&D.forEach(t=>{e[t]=.5}),{inputs:{resources:R?{[R]:.5}:{},products:e},outputs:{resources:{},products:F?{[F]:1}:{}}}})(),eo=e=>new Intl.NumberFormat("en-US",{maximumFractionDigits:2}).format(e),ec=(e,t)=>{if(!e)return null;let r=Object.entries(e.inputs.resources||{}).filter(e=>{let[,t]=e;return t>0}),s=Object.entries(e.inputs.products||{}).filter(e=>{let[,t]=e;return t>0}),a=Object.entries(e.outputs.resources||{}).filter(e=>{let[,t]=e;return t>0}),n=Object.entries(e.outputs.products||{}).filter(e=>{let[,t]=e;return t>0});return 0===r.length&&0===s.length&&0===a.length&&0===n.length?null:{inputs:{resources:r.map(e=>{let[r,s]=e;return{name:r,perUnit:s,total:s*t}}),products:s.map(e=>{let[r,s]=e;return{name:r,perUnit:s,total:s*t}})},outputs:{resources:a.map(e=>{let[r,s]=e;return{name:r,perUnit:s,total:s*t}}),products:n.map(e=>{let[r,s]=e;return{name:r,perUnit:s,total:s*t}})}}},ed=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=[];return Object.entries(e.resources||{}).forEach(e=>{var t,r;let[a,n]=e,l=null!==(r=null==Y?void 0:null===(t=Y[a])||void 0===t?void 0:t.currentPrice)&&void 0!==r?r:0;s.push({name:a,amount:n,price:l,costHr:n*l})}),Object.entries(e.products||{}).forEach(e=>{var a,n,l;let[i,o]=e,c=null!==(l=null!==(n=null==J?void 0:null===(a=J[i])||void 0===a?void 0:a.currentPrice)&&void 0!==n?n:$[i])&&void 0!==l?l:0,d="Electricity"===t&&"Electricity"===i?.1:1;r&&"Electricity"!==i?d*=.8:"Light Industry"===N&&"Electricity"!==i&&(d=.995),s.push({name:i,amount:o,price:c,costHr:o*c*d})}),s},eu=()=>{if(!S||0===S.length||!Y)return z.extraction.baseRevenue;let e=S[0];return Y[e]?Y[e].currentPrice*K:z.extraction.baseRevenue},ex=eu(),em=ec(null==Q?void 0:Q.retail,C.retail),ep=ec(ei||void 0,C.production),eh=ec(null==Q?void 0:Q.service,C.service),ev=ec(null==Q?void 0:Q.extraction,C.extraction||0),eg=ed({resources:Object.fromEntries(((null==em?void 0:em.inputs.resources)||[]).map(e=>[e.name,e.perUnit])),products:Object.fromEntries(((null==em?void 0:em.inputs.products)||[]).map(e=>[e.name,e.perUnit]))},null,ee),eb=eg.reduce((e,t)=>e+t.costHr,0),ej=((null==em?void 0:em.inputs.products)||[]).reduce((e,t)=>{var r,s,a;let n=null!==(a=null!==(s=null==J?void 0:null===(r=J[t.name])||void 0===r?void 0:r.currentPrice)&&void 0!==s?s:$[t.name])&&void 0!==a?a:0,l=(ee&&t.name,1);return ee&&"Electricity"!==t.name?e+n*t.perUnit*.8*l:e+n*t.perUnit},0),ef=ej||z.retail.baseRevenue,ey=(eb||z.retail.baseCost)/Math.max(1,U),eN=ed({resources:Object.fromEntries(((null==eh?void 0:eh.inputs.resources)||[]).map(e=>[e.name,e.perUnit])),products:Object.fromEntries(((null==eh?void 0:eh.inputs.products)||[]).map(e=>[e.name,e.perUnit]))},null,ee),ew=eN.reduce((e,t)=>e+t.costHr,0),ek=((null==eh?void 0:eh.inputs.products)||[]).reduce((e,t)=>{var r,s,a;let n=null!==(a=null!==(s=null==J?void 0:null===(r=J[t.name])||void 0===r?void 0:r.currentPrice)&&void 0!==s?s:$[t.name])&&void 0!==a?a:0,l=(ee&&t.name,1);return ee&&"Electricity"!==t.name?e+n*t.perUnit*.8*l:e+n*t.perUnit},0),eE=ek||z.service.baseRevenue,eU=(ew||z.service.baseCost)/Math.max(1,U),eP=F&&null!==(v=null==ei?void 0:null===(t=ei.outputs.products)||void 0===t?void 0:t[F])&&void 0!==v?v:1,eC=F?null!==(b=null!==(g=null==J?void 0:null===(r=J[F])||void 0===r?void 0:r.currentPrice)&&void 0!==g?g:$[F])&&void 0!==b?b:z.production.baseRevenue:0,eH=F&&null!==(f=null!==(j=null==J?void 0:null===(p=J[F])||void 0===p?void 0:p.referenceValue)&&void 0!==j?j:$[F])&&void 0!==f?f:0,eO=z.production.baseRevenue,eS=z.production.baseCost;F&&(eO=eH+eC*eP,eS=400,Object.entries((null==ei?void 0:ei.inputs.resources)||{}).forEach(e=>{var t,r;let[s,a]=e,n=null!==(r=null==Y?void 0:null===(t=Y[s])||void 0===t?void 0:t.currentPrice)&&void 0!==r?r:0;eS+=a*n}),Object.entries((null==ei?void 0:ei.inputs.products)||{Electricity:.5}).forEach(e=>{var t,r,s;let[a,n]=e,l=null!==(s=null!==(r=null==J?void 0:null===(t=J[a])||void 0===t?void 0:t.currentPrice)&&void 0!==r?r:$[a])&&void 0!==s?s:0;eS+=n*l*("Electricity"===F&&"Electricity"===a?.1:1)}));let eR=eO-eS,eF=ed({resources:Object.fromEntries(((null==ev?void 0:ev.inputs.resources)||[]).map(e=>[e.name,e.perUnit])),products:Object.fromEntries(((null==ev?void 0:ev.inputs.products)||[]).map(e=>[e.name,e.perUnit]))}).reduce((e,t)=>e+t.costHr,0),eD=z.extraction.baseCost+eF,eM=S&&S.length>0&&null!==(y=null==Y?void 0:null===(h=Y[S[0]])||void 0===h?void 0:h.basePrice)&&void 0!==y?y:0,eZ=eM+ex,eI=e=>{if(!e)return null;let t=[...e.inputs.resources.map(e=>({name:e.name,perUnit:e.perUnit})),...e.inputs.products.map(e=>({name:e.name,perUnit:e.perUnit}))],r=[...e.outputs.resources.map(e=>({name:e.name,perUnit:e.perUnit})),...e.outputs.products.map(e=>({name:e.name,perUnit:e.perUnit}))],a=t.slice(0,3),n=r.slice(0,3),l=Math.max(0,t.length-a.length),i=Math.max(0,r.length-n.length);return(0,s.jsxs)("div",{className:"mt-2 flex flex-wrap gap-1",children:[a.map(e=>(0,s.jsxs)("span",{className:"px-2 py-0.5 rounded-full text-[10px] bg-amber-100 dark:bg-amber-900/30 text-amber-800 dark:text-amber-200",children:[e.name," ",eo(e.perUnit),"/u/hr"]},"in-".concat(e.name))),l>0&&(0,s.jsxs)("span",{className:"px-2 py-0.5 rounded-full text-[10px] bg-amber-50 dark:bg-amber-900/10 text-amber-700 dark:text-amber-300",children:["+",l," in"]}),n.map(e=>(0,s.jsxs)("span",{className:"px-2 py-0.5 rounded-full text-[10px] bg-emerald-100 dark:bg-emerald-900/30 text-emerald-800 dark:text-emerald-200",children:[e.name," ",eo(e.perUnit),"/u/hr"]},"out-".concat(e.name))),i>0&&(0,s.jsxs)("span",{className:"px-2 py-0.5 rounded-full text-[10px] bg-emerald-50 dark:bg-emerald-900/10 text-emerald-700 dark:text-emerald-300",children:["+",i," out"]})]})};return(0,s.jsxs)("div",{className:"rounded-xl border border-white/60 bg-white/70 dark:border-gray-800/70 dark:bg-gray-800/60 p-4 shadow-sm",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4 mb-4",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white",children:N}),O&&(0,s.jsxs)("span",{className:"text-xs font-normal text-amber-600 dark:text-amber-400 flex items-center gap-1",children:[(0,s.jsx)(a.Z,{className:"w-3 h-3"}),"Extraction"]})]}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1 text-xs text-gray-500 dark:text-gray-400",children:[(0,s.jsxs)("span",{children:["Entered ",new Date(P).toLocaleDateString()]}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"•"}),(0,s.jsxs)("span",{className:"font-mono ".concat(el?"text-red-600 dark:text-red-400":en>=80?"text-amber-600 dark:text-amber-400":"text-gray-500 dark:text-gray-400"),children:[es,"/",ea," units"]}),el&&(0,s.jsx)("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300",children:"AT CAPACITY"}),H&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"hidden sm:inline",children:"•"}),(0,s.jsxs)(m.default,{href:"/corporation/".concat(H.id),className:"flex items-center gap-1 hover:text-corporate-blue dark:hover:text-corporate-blue-light transition-colors",children:[H.logo?(0,s.jsx)("img",{src:H.logo,alt:H.name,className:"w-4 h-4 rounded object-cover",onError:e=>{e.currentTarget.src="/defaultpfp.jpg"}}):(0,s.jsx)(n.Z,{className:"w-4 h-4"}),(0,s.jsx)("span",{className:"truncate max-w-[120px] sm:max-w-none",children:H.name})]})]}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"•"}),(0,s.jsxs)(m.default,{href:"/states/".concat(w),className:"flex items-center gap-1 hover:text-corporate-blue dark:hover:text-corporate-blue-light transition-colors",children:[(0,s.jsx)(l.Z,{className:"w-3 h-3"}),k]})]})]}),void 0!==M&&void 0!==Z&&(0,s.jsxs)("div",{className:"flex items-center gap-3 sm:gap-4 flex-shrink-0",children:[(0,s.jsxs)("div",{className:"text-right group relative",children:[(0,s.jsx)("p",{className:"text-sm font-bold text-emerald-600 dark:text-emerald-400 font-mono",children:G(M)}),(0,s.jsx)("p",{className:"text-[10px] sm:text-xs text-gray-500 dark:text-gray-400",children:"revenue/96h"})]}),(0,s.jsxs)("div",{className:"text-right group relative",children:[(0,s.jsx)("p",{className:"text-sm font-bold font-mono ".concat(Z>=0?"text-emerald-600 dark:text-emerald-400":"text-red-600 dark:text-red-400"),children:G(Z)}),(0,s.jsx)("p",{className:"text-[10px] sm:text-xs text-gray-500 dark:text-gray-400",children:"profit/96h"})]})]})]}),(0,s.jsxs)("div",{className:"grid gap-2 sm:gap-3 ".concat(4===[et,er,!0,O].filter(Boolean).length?"grid-cols-2 lg:grid-cols-4":3===[et,er,!0,O].filter(Boolean).length?"grid-cols-1 sm:grid-cols-3":2===[et,er,!0,O].filter(Boolean).length?"grid-cols-2":"grid-cols-1"),children:[et&&(0,s.jsxs)("div",{className:"rounded-lg border border-gray-200 dark:border-gray-700 p-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)(i.Z,{className:"h-4 w-4 text-pink-500"}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Retail"})]}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:C.retail}),(0,s.jsxs)("div",{className:"group relative inline-block",children:[(0,s.jsxs)("p",{className:"text-xs text-emerald-600 dark:text-emerald-400 cursor-help",children:["+",G(q("retail")*C.retail),"/96hr"]}),(0,s.jsx)(u,{children:(0,s.jsx)(x,{title:"Retail Financials",revenueHr:ef,costHr:ey,profitHr:ef-ey,outputSoldUnits:Math.round(((null==em?void 0:em.inputs.products)||[]).reduce((e,t)=>e+t.total,0)),costItems:eg.map(e=>({name:e.name,costHr:e.costHr})),breakdown:[{label:"Base",value:ee?0:z.retail.baseRevenue},{label:ee?"Cost-Plus Revenue":"Price \xd7 Output",value:ej}],note:ee?"Defense sector: 1.0 consumption, 0.8x wholesale price, 1.0x cost revenue":"Demand-based cost factor applied: \xf7 Growth ".concat(U.toFixed(2),"x (1 + 25% \xd7 sector growth avg)")})})]}),I&&(0,s.jsxs)("div",{className:"mt-2 flex gap-1",children:[B&&(0,s.jsx)("button",{onClick:()=>B("retail"),disabled:"retail"===T||!V||el,className:"flex-1 px-2 py-1 text-xs bg-pink-500 text-white rounded hover:bg-pink-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"retail"===T?"...":el?"At Capacity":"+1 (".concat(G(_),")")}),A&&C.retail>0&&(0,s.jsx)("button",{onClick:()=>A("retail"),disabled:"retail"===L,className:"px-2 py-1 text-xs bg-red-600 text-white rounded hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"Abandon 1 retail unit",children:"retail"===L?"...":(0,s.jsx)(o.Z,{className:"w-3 h-3"})})]})]}),er&&(0,s.jsxs)("div",{className:"rounded-lg border border-gray-200 dark:border-gray-700 p-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)(c.Z,{className:"h-4 w-4 text-orange-500"}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Production"})]}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:C.production}),(0,s.jsxs)("div",{className:"group relative inline-block",children:[(0,s.jsxs)("p",{className:"text-xs text-emerald-600 dark:text-emerald-400 cursor-help",children:["+",G(q("production")*C.production),"/96hr"]}),(0,s.jsx)(u,{children:(0,s.jsx)(x,{title:"Production Financials",revenueHr:eO,costHr:eS,profitHr:eR,outputSoldUnits:Math.round(((null==ep?void 0:ep.outputs.products)||[]).reduce((e,t)=>e+t.total,0)+((null==ep?void 0:ep.outputs.resources)||[]).reduce((e,t)=>e+t.total,0)),costItems:[...ed({resources:Object.fromEntries(((null==ep?void 0:ep.inputs.resources)||[]).map(e=>[e.name,e.perUnit])),products:Object.fromEntries(((null==ep?void 0:ep.inputs.products)||[]).map(e=>[e.name,e.perUnit]))},F).map(e=>({name:e.name,costHr:e.costHr})),{name:"Labor/Operations",costHr:400}],breakdown:[{label:"Base",value:eH},{label:"Price \xd7 Output",value:eC*eP}]})})]}),I&&(0,s.jsxs)("div",{className:"mt-2 flex gap-1",children:[B&&(0,s.jsx)("button",{onClick:()=>B("production"),disabled:"production"===T||!V||el,className:"flex-1 px-2 py-1 text-xs bg-orange-500 text-white rounded hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"production"===T?"...":el?"At Capacity":"+1 (".concat(G(_),")")}),A&&C.production>0&&(0,s.jsx)("button",{onClick:()=>A("production"),disabled:"production"===L,className:"px-2 py-1 text-xs bg-red-600 text-white rounded hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"Abandon 1 production unit",children:"production"===L?"...":(0,s.jsx)(o.Z,{className:"w-3 h-3"})})]})]}),(0,s.jsxs)("div",{className:"rounded-lg border border-gray-200 dark:border-gray-700 p-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)(d.Z,{className:"h-4 w-4 text-blue-500"}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Service"})]}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:C.service}),(0,s.jsxs)("div",{className:"group relative inline-block",children:[(0,s.jsxs)("p",{className:"text-xs text-emerald-600 dark:text-emerald-400 cursor-help",children:["+",G(q("service")*C.service),"/96hr"]}),(0,s.jsx)(u,{children:(0,s.jsx)(x,{title:"Service Financials",revenueHr:eE,costHr:eU,profitHr:eE-eU,outputSoldUnits:Math.round(((null==eh?void 0:eh.inputs.products)||[]).reduce((e,t)=>e+t.total,0)),costItems:eN.map(e=>({name:e.name,costHr:e.costHr})),breakdown:[{label:"Base",value:ee?0:z.service.baseRevenue},{label:ee?"Cost-Plus Revenue":"Price \xd7 Output",value:ek}],note:ee?"Defense sector: 1.0 consumption, 0.8x wholesale price, 1.0x cost revenue":"Demand-based cost factor applied: \xf7 Growth ".concat(U.toFixed(2),"x (1 + 25% \xd7 sector growth avg)")})})]}),I&&(0,s.jsxs)("div",{className:"mt-2 flex gap-1",children:[B&&(0,s.jsx)("button",{onClick:()=>B("service"),disabled:"service"===T||!V||el,className:"flex-1 px-2 py-1 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"service"===T?"...":el?"At Capacity":"+1 (".concat(G(_),")")}),A&&C.service>0&&(0,s.jsx)("button",{onClick:()=>A("service"),disabled:"service"===L,className:"px-2 py-1 text-xs bg-red-600 text-white rounded hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"Abandon 1 service unit",children:"service"===L?"...":(0,s.jsx)(o.Z,{className:"w-3 h-3"})})]})]}),O&&(0,s.jsxs)("div",{className:"rounded-lg border border-gray-200 dark:border-gray-700 p-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)(a.Z,{className:"h-4 w-4 text-amber-500"}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Extraction"})]}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:C.extraction||0}),(0,s.jsxs)("div",{className:"group relative inline-block",children:[(0,s.jsxs)("p",{className:"text-xs text-emerald-600 dark:text-emerald-400 cursor-help",children:["+",G(q("extraction")*(C.extraction||0)),"/96hr"]}),(0,s.jsx)(u,{children:(0,s.jsx)(x,{title:"Extraction Financials",revenueHr:eZ,costHr:eD,profitHr:eZ-eD,outputSoldUnits:Math.round(((null==ev?void 0:ev.outputs.resources)||[]).reduce((e,t)=>e+t.total,0)),costItems:[...ed({resources:Object.fromEntries(((null==ev?void 0:ev.inputs.resources)||[]).map(e=>[e.name,e.perUnit])),products:Object.fromEntries(((null==ev?void 0:ev.inputs.products)||[]).map(e=>[e.name,e.perUnit]))}).map(e=>({name:e.name,costHr:e.costHr})),{name:"Labor",costHr:z.extraction.baseCost}],breakdown:[{label:"Base Price",value:eM},{label:"Market Revenue",value:eu()},{label:"Total Cost/Unit",value:eD/K}]})})]}),I&&(0,s.jsxs)("div",{className:"mt-2 flex gap-1",children:[B&&(0,s.jsx)("button",{onClick:()=>B("extraction"),disabled:"extraction"===T||!V||el,className:"flex-1 px-2 py-1 text-xs bg-amber-500 text-white rounded hover:bg-amber-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"extraction"===T?"...":el?"At Capacity":"+1 (".concat(G(_),")")}),A&&(C.extraction||0)>0&&(0,s.jsx)("button",{onClick:()=>A("extraction"),disabled:"extraction"===L,className:"px-2 py-1 text-xs bg-red-600 text-white rounded hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"Abandon 1 extraction unit",children:"extraction"===L?"...":(0,s.jsx)(o.Z,{className:"w-3 h-3"})})]})]})]}),(em||ep||eh||ev)&&(0,s.jsxs)("div",{className:"mt-3 space-y-2",children:[C.retail>0&&em&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Retail flows"}),eI(em)]}),C.production>0&&ep&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Production flows"}),eI(ep)]}),C.service>0&&eh&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Service flows"}),eI(eh)]}),O&&(C.extraction||0)>0&&ev&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Extraction flows"}),eI(ev)]})]})]})}},40398:function(e,t,r){r.d(t,{ZV:function(){return i}});var s=r(58078),a=r(64790);let n=null,l=null;function i(){let[e,t]=(0,s.useState)(n),[r,i]=(0,s.useState)(!n),[o,c]=(0,s.useState)(null),d=(0,s.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!e&&n){t(n),i(!1);return}if(l){try{let e=await l;t(e),i(!1)}catch(e){c(e.message||"Failed to fetch sector configuration"),i(!1)}return}i(!0),c(null),l=a.cW.getConfig();try{let e=await l;n=e,e.version,t(e)}catch(e){console.error("Failed to fetch sector config:",e),c(e.message||"Failed to fetch sector configuration")}finally{i(!1),l=null}},[]),u=(0,s.useCallback)(async()=>{n=null,await d(!0)},[d]);(0,s.useEffect)(()=>{d()},[d]);let x=(0,s.useMemo)(()=>({getSectorProduct:t=>{var r;return e&&(null===(r=e.sectors[t])||void 0===r?void 0:r.producedProduct)||null},getSectorResource:t=>{var r;return e&&(null===(r=e.sectors[t])||void 0===r?void 0:r.primaryResource)||null},getProductReferenceValue:t=>{var r,s;return e&&null!==(s=null===(r=e.products[t])||void 0===r?void 0:r.referenceValue)&&void 0!==s?s:1e3},getResourceBasePrice:t=>{var r,s;return e&&null!==(s=null===(r=e.resources[t])||void 0===r?void 0:r.basePrice)&&void 0!==s?s:100},getSectorsProducingProduct:t=>{if(!e)return[];let r=[];for(let[s,a]of Object.entries(e.sectors))a.producedProduct===t&&r.push(s);return r},getSectorsDemandingProduct:t=>{if(!e)return[];let r=[];for(let[s,a]of Object.entries(e.sectors)){let e=[];for(let r of["production","retail","service","extraction"]){let s=a.units[r];s.isEnabled&&s.inputs.some(e=>"product"===e.type&&e.name===t)&&e.push(r)}e.length>0&&r.push({sector:s,unitTypes:e})}return r},getSectorsExtractingResource:t=>{if(!e)return[];let r=[];for(let[s,a]of Object.entries(e.sectors))a.units.extraction.outputs.some(e=>"resource"===e.type&&e.name===t)&&r.push(s);return r},getSectorsDemandingResource:t=>{if(!e)return[];let r=[];for(let[s,a]of Object.entries(e.sectors)){let e=[];for(let r of["production","retail","service","extraction"]){let s=a.units[r];s.isEnabled&&s.inputs.some(e=>"resource"===e.type&&e.name===t)&&e.push(r)}e.length>0&&r.push({sector:s,unitTypes:e})}return r},getUnitInputs:(t,r)=>{var s,a;return e&&(null===(a=e.sectors[t])||void 0===a?void 0:null===(s=a.units[r])||void 0===s?void 0:s.inputs)||[]},getUnitOutputs:(t,r)=>{var s,a;return e&&(null===(a=e.sectors[t])||void 0===a?void 0:null===(s=a.units[r])||void 0===s?void 0:s.outputs)||[]}}),[e]);return{config:e,loading:r,error:o,refetch:u,...x}}}}]);